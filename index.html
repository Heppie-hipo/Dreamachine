yes<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dreamachine</title>
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Lora:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div id="vanta-bg"></div>
    
    <!-- Sidebar Toggle Button - Visible in onboarding, hidden during experience -->
    <button id="sidebar-toggle">
        <i class="fas fa-bars"></i>
    </button>
    
    <!-- Sidebar -->
    <div id="sidebar">
        <button id="sidebar-close"><i class="fas fa-times"></i></button>
        <div class="sidebar-content">
            <div class="sidebar-section">
                <div class="sidebar-header">
                    <h3>About Dreamachine</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="sidebar-body">
                    <p>The Dreamachine is a device that produces visual stimuli to create an altered state of consciousness. It was created by artist Brion Gysin and scientist Ian Sommerville.</p>
                </div>
            </div>
            
            <div class="sidebar-section">
                <div class="sidebar-header">
                    <h3>How It Works</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="sidebar-body">
                    <p>The stroboscopic flicker effect causes neural oscillations in the brain to synchronize with the rhythm of the flashing light, producing a "frequency following response" that can lead to hypnagogic experiences.</p>
                </div>
            </div>
            
            <div class="sidebar-section">
                <div class="sidebar-header">
                    <h3>History</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="sidebar-body">
                    <p>First designed in 1957, the Dreamachine was inspired by the observations of scientists who noticed that patients experienced hallucinations when they closed their eyes and faced sunlight while passing rows of trees.</p>
                </div>
            </div>
            
            <div class="sidebar-section">
                <div class="sidebar-header">
                    <h3>Scientific Background</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="sidebar-body">
                    <p>The principle behind the Dreamachine relates to how the brain processes rhythmic visual stimulation. Specific frequencies (particularly around 8-13 Hz) can induce alpha and theta brainwaves associated with relaxation and dreamlike states.</p>
                </div>
            </div>
            
            <div class="sidebar-section">
                <div class="sidebar-header">
                    <h3>Tips</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="sidebar-body">
                    <p>For the best experience, use the Dreamachine in a dark room. Keep your eyes closed and face the light source. Adjust the frequency to find what works best for your mind.</p>
                </div>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-header">
                    <h3>About This Project</h3>
                    <i class="fas fa-chevron-down"></i>
                </div>
                <div class="sidebar-body">
                    <p>This project is a personal exploration of consciousness — built for those drawn to altered states, inner vision, and the subtle edges of perception.</p>
                    <p>Inspired by the original Dreamachine concept by Brion Gysin and Ian Sommerville, this version isn't a replica — it's a reimagining. A digital experiment in rhythm, light, and mind. It lives in the browser, works with any screen, and is made to be accessible to anyone curious enough to try.</p>
                    <p>This isn't a product. It's not for profit or attention. It's a tool, a ritual, a visual pulse meant to guide you toward that liminal space — between waking and dreaming, between noise and stillness.</p>
                    <p>Not everyone will connect with it. And that's okay.<br>It's for the psychonauts, the lucid dreamers, the ones who seek what can't quite be described.</p>
                    <p>If that's you — welcome.</p>
                </div>
            </div>
        </div>
    </div>
    
    <div id="onboarding-container">
        <!-- Step 1: Welcome -->
        <div id="welcome-screen" class="onboarding-step active">
            <div class="onboarding-content">
                <h1 class="onboarding-title">Welcome to the Dreamachine</h1>
                <p class="onboarding-text">A journey inward, through flicker, light, and sound.</p>
                <p class="onboarding-text">Inspired by Brion Gysin's original invention, this digital Dreamachine is an eyes-closed experience that uses rhythmic light and sound to stimulate altered states of consciousness. What you see inside — is your own mind.</p>
                <p class="onboarding-quote">"The Dreamachine is the first artwork to be experienced with the eyes closed."<br>— Brion Gysin</p>
                <button id="welcome-continue-btn" class="onboarding-button">Continue</button>
            </div>
        </div>

        <!-- Step 2: Disclaimer -->
        <div id="disclaimer-screen" class="onboarding-step">
            <div class="onboarding-content">
                <h2 class="onboarding-title">⚠️ Important Disclaimer</h2>
                <p class="onboarding-text">Please read carefully before beginning:</p>
                <ul class="disclaimer-list">
                    <li>This experience uses high-frequency flickering light. It may trigger seizures in people with photosensitive epilepsy or related conditions.</li>
                    <li>Do not proceed if you are unsure of your sensitivity to strobe effects.</li>
                    <li>This is not a medical device, and is not intended to treat, cure, or diagnose any condition.</li>
                    <li>Dreamachine is designed for artistic, meditative, and introspective purposes only.</li>
                    <li>By continuing, you accept full responsibility for your experience.</li>
                </ul>
                <button id="disclaimer-agree-btn" class="onboarding-button">I Understand & Agree</button>
            </div>
        </div>

        <!-- Step 3: Preparation -->
        <div id="preparation-screen" class="onboarding-step">
            <div class="onboarding-content">
                <h2 class="onboarding-title">Preparation</h2>
                <ul class="preparation-list">
                    <li>Sit or lie down in a safe, quiet space.</li>
                    <li>Close your eyes gently. Keep them closed throughout.</li>
                    <li>Take a few deep breaths. Let go of expectations.</li>
                    <li>Use headphones or good speakers for best audio quality.</li>
                    <li>Allow the flicker to wash over your inner field of vision.</li>
                </ul>
                <h3 class="onboarding-subtitle">Begin When You Are Ready</h3>
                <p class="onboarding-text">You are about to enter a world that isn't rendered — it's revealed.<br>Not from the screen — but from the deep architecture of your own mind.</p>
                <button id="begin-experience-btn" class="onboarding-button">Begin Experience</button>
            </div>
        </div>
    </div>

    <div id="dreamachine-container" class="hidden">
        <canvas id="dreamachine-canvas" class="hidden"></canvas>
        <canvas id="threejs-canvas"></canvas>
        <div id="controls">
            <div class="control-group frequency-slider-group">
                <label for="freq-slider">Frequency</label>
                <input type="range" min="0" max="3" value="1" id="freq-slider">
                <span id="hz-value">10.0 Hz</span>
            </div>
            
            <!-- Music Player Controls -->
            <div class="control-group music-control-group">
                <button id="next-track" class="music-button">
                    Change Track
                </button>
            </div>
            
            <div class="control-group">
                <label for="sound-toggle">Sound</label>
                <button id="sound-toggle" class="control-button">On</button>
            </div>
            <div class="control-group">
                <button id="exit-button" class="control-button exit">Exit</button>
            </div>
        </div>
    </div>
    <div id="exit-message" class="hidden">
        <p>Thank you for using the Dreamachine. Come back soon.</p>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.fog.min.js"></script>
    <script>
        const palettes = [
            { highlight: 0xff0077, midtone: 0xd500f9, lowlight: 0x651fff }, // Deep Purple/Pink
            { highlight: 0x00e5ff, midtone: 0x00b0ff, lowlight: 0x2962ff }, // Ocean Blue
            { highlight: 0xeeff41, midtone: 0x64dd17, lowlight: 0x00bfa5 }, // Jungle Green
            { highlight: 0xff9100, midtone: 0xff3d00, lowlight: 0xd50000 }, // Sunset Orange/Red
            { highlight: 0xbe93fd, midtone: 0x9b59b6, lowlight: 0x4a235a }, // Mystic Violet
            { highlight: 0xfdd835, midtone: 0xffb300, lowlight: 0xf57c00 }, // Sunrise
            { highlight: 0x42f5b9, midtone: 0x2196f3, lowlight: 0x3f51b5 }, // Aurora
            { highlight: 0x69f0ae, midtone: 0x00c853, lowlight: 0x004d40 }, // Enchanted Forest
            { highlight: 0xe1bee7, midtone: 0xba68c8, lowlight: 0x8e24aa }, // Cosmic Lilac
            { highlight: 0xff5252, midtone: 0xff1744, lowlight: 0x448aff }, // Fire and Ice
            { highlight: 0xffecb3, midtone: 0xffd54f, lowlight: 0xff8f00 }, // Golden Haze
            { highlight: 0x4dd0e1, midtone: 0x00bcd4, lowlight: 0x006064 }, // Deep Sea
            { highlight: 0xf8bbd0, midtone: 0xf06292, lowlight: 0xc2185b }, // Raspberry Sorbet
            { highlight: 0xa5d6a7, midtone: 0x66bb6a, lowlight: 0x1b5e20 }, // Emerald City
            { highlight: 0xd1c4e9, midtone: 0x9575cd, lowlight: 0x4527a0 }, // Lavender Sky
            { highlight: 0xb0bec5, midtone: 0x78909c, lowlight: 0x37474f }, // Volcanic Ash
            { highlight: 0xffab91, midtone: 0xff7043, lowlight: 0xe64a19 }, // Coral Reef
            { highlight: 0xc5cae9, midtone: 0x7986cb, lowlight: 0x283593 }, // Winter Night
            { highlight: 0xffe0b2, midtone: 0xffb74d, lowlight: 0xef6c00 }, // Desert Sands
            { highlight: 0x9fa8da, midtone: 0x5c6bc0, lowlight: 0x1a237e }  // Galactic Glow
        ];

        let currentPaletteIndex = 0;

        let vantaEffect = VANTA.FOG({
            el: "#vanta-bg",
            mouseControls: true,
            touchControls: true,
            gyroControls: false,
            minHeight: 200.00,
            minWidth: 200.00,
            highlightColor: palettes[0].highlight,
            midtoneColor: palettes[0].midtone,
            lowlightColor: palettes[0].lowlight,
            baseColor: 0x0,
            blurFactor: 0.50,
            speed: 1.20,
            zoom: 1.50
        });

        function hexToRgb(hex) {
            const r = (hex >> 16) & 255;
            const g = (hex >> 8) & 255;
            const b = hex & 255;
            return { r, g, b };
        }

        function rgbToHex(r, g, b) {
            return (r << 16) + (g << 8) + b;
        }

        function interpolateColor(color1, color2, factor) {
            const rgb1 = hexToRgb(color1);
            const rgb2 = hexToRgb(color2);
            const r = Math.round(rgb1.r + factor * (rgb2.r - rgb1.r));
            const g = Math.round(rgb1.g + factor * (rgb2.g - rgb1.g));
            const b = Math.round(rgb1.b + factor * (rgb2.b - rgb1.b));
            return rgbToHex(r, g, b);
        }

        function transitionToNextPalette() {
            if (!vantaEffect) return;

            const fromPalette = palettes[currentPaletteIndex];
            currentPaletteIndex = (currentPaletteIndex + 1) % palettes.length;
            const toPalette = palettes[currentPaletteIndex];

            const duration = 2000; // 2 seconds for transition
            let startTime = null;

            function animate(currentTime) {
                if (!startTime) startTime = currentTime;
                const elapsedTime = currentTime - startTime;
                const progress = Math.min(elapsedTime / duration, 1);

                vantaEffect.setOptions({
                    highlightColor: interpolateColor(fromPalette.highlight, toPalette.highlight, progress),
                    midtoneColor: interpolateColor(fromPalette.midtone, toPalette.midtone, progress),
                    lowlightColor: interpolateColor(fromPalette.lowlight, toPalette.lowlight, progress),
                });

                if (progress < 1) {
                    requestAnimationFrame(animate);
                }
            }

            requestAnimationFrame(animate);
        }
        
        // Use a recursive timeout to ensure consistent timing between transitions.
        function scheduleNextTransition() {
            transitionToNextPalette();
            setTimeout(scheduleNextTransition, 4000); // 2s transition + 2s pause = 4s interval
        }

        // Start the transitions after a brief initial pause.
        setTimeout(scheduleNextTransition, 100);
    </script>
    <script src="https://cdn.jsdelivr.net/npm/tone@14.7.77/build/Tone.min.js"></script>
    <script type="module" src="script.js"></script>
</body>
</html> 